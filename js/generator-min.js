function setupButtons(){document.getElementById("artsubmit").addEventListener("click",(function(e){e.preventDefault();var t=getFormData();console.log(t.djimage),t.djimage?convertImageToBase64(t.djimage):postFormToServer(t,!1)}))}function convertImageToBase64(e){var t=document.getElementById("converter-img");if(e.size>0){var n=new FileReader;n.onload=function(e){t.src=e.target.result,postFormToServer(getFormData(),!0)},n.readAsDataURL(e)}}function getFormData(){var e=document.getElementById("djcreds"),t=new FormData(e),n=Object.fromEntries(t);return console.log(n),n}function postFormToServer(e,t){let n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");n.onreadystatechange=function(){if(4===this.readyState&&200===this.status&&this.responseText){var e=document.getElementById("art-preview"),t=JSON.parse(this.responseText);e.src=t.img}};var o="";t&&(o=document.getElementById("converter-img").src);var r="payload="+encodeURIComponent(JSON.stringify({id:e.templateid,text1:encodeURIComponent(e.text1),text2:encodeURIComponent(e.text2),text3:encodeURIComponent(e.text3),text4:encodeURIComponent(e.text4),img:encodeURIComponent(o)}));console.log(r),n.open("POST","/",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(r)}document.addEventListener("DOMContentLoaded",(function(){setupButtons()}));